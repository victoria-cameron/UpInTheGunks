﻿
<html lang="en">
<head>
    <link rel="stylesheet" href="css/gunks.css">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body id="fill_survey" onload="showSurveyList();"> <!--Allows you to run the function when the page loads-->
    <div>
        <h1>Fill Survey</h1>
        <h3>Select the survey you will be filling.</h3>
    </div>

    <!--<div id="search" style="margin-left: 80%">
        <input type="text" value="Filter By" id="filterBy">
        <button type="button" id="search">Search</button><br>
    </div>-->

    <div class="file" id="tableForm">
        <!--<h3 style="text-align: center">Creator | Created | Title | Description </h3>-->
        <table id="surveyTable"></table>

        <!-- <div id = "bar">
             <h3 style="text-align: center">Creator | Created | Title | Description </h3>
             <div id = "search" style = "margin-right: 50%">
             <button type = "button" id = "select">Select</button><br>
             </div>
         </div>-->
    </div>

    <script type="text/javascript">
        //document.getElementById("select").addEventListener("click", function() {
        //    showSurveyList();
        //}, false);

        function showSurveyList() {
            var test = document.getElementById('surveyTable');
            var url = 'http://10.10.9.145:3000/api/surveys';
            fetch(url) // Connection to api
                .then(surveyList => surveyList.json()) // Transform data into json
                .then(function (data) {
                    let surveyResult = ``;
                    data.forEach((survey) => {
                        const {
                            SurvID,
                            SurvCreated,
                            SurvCreator,
                            SurvTitle,
                            SurvDescription } = survey
                        var tabber = document.createElement("button"); //creates a button that can be clicked (Will be what takes you to the actuall filling of the survey)
                        var tabberValue = document.createTextNode(SurvID); //Makes the survey ID the text of the button, can be any field (I would make it the title)
                        tabber.appendChild(tabberValue); //Adds the value to the button
                        surveyResult +=
                            tabber.outerHTML + `\t
                             ${SurvTitle} <br>
                             &emsp;&emsp;&emsp;&emsp; Creator: ${SurvCreator} <br>
                             &emsp;&emsp;&emsp;&emsp; Created: ${SurvCreated} <br>
                             &emsp;&emsp;&emsp;&emsp; Description: ${SurvDescription} <br><br>`; //Makes the individual look of a survey for the list and adds it to the results that are gonna be printed
                        //var cols = ["Creator ", "Created ", "Title ", "Description "];
                        //document.getElementById("surveyTable").innerHTML = makeTableHTML(cols);
                        document.getElementById("tableForm").innerHTML = surveyResult; //Prints our results 
                    });

                })
        }

        function makeTableHTML(hi) {
            var result = document.getElementById("surveyTable");
            for (var i = 0; i < hi.length; i++) {
                result += "<tr>" + hi[i] + "</tr>";
                /*for(var j=0; j<cols[i].length; j++){
                    result += "<td>"+cols[i][j]+"</td>";
                }

                result += "</tr>";*/
            }
            result += "</table>";

            return result;
        }


    </script>


</body>
</html>

<script>

</script>